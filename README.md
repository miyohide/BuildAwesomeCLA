# Build Awesome Command-Line Applications in Ruby2 読書ログ
## 2015年1月2日（金）

- GLIの`scaffold`で生成されたソースコードの解説がP27から。
- P28から生成されたソースコードに対して手を加えていく。
- グローバルオプションとして、`f`オプション。ファイル名の指定。
- `new`サブコマンドに対して`priority`オプションと`f`スイッチを追加する。
  - グローバルオプションの`f`オプションと`f`スイッチの違いはどうやって判断するんだろう。
    - サブコマンドの前に`f`オプションがあればグローバルオプションとして判断される。
    - サブコマンドの後に`f`オプションがあればスイッチとして判断される。
- `list`サブコマンドに対しては、`s`オプション。
- `done`サブコマンドに対しては、特に何も追加しない。

## 2014年12月29日（月）

- P23にてserverオプションを追加。serverオプションの妥当性はハッシュで指定できる。
- ここでserverオプションを追加するときに既存のコードがsyntaxエラーで落ちることがわかった。
  - テストを書かないとあかんなぁ。
  - `end_if_iter`の役割がやっぱりわからない。`true`/`false`なのか、なにか値を取るのか。途中で意味が変わっている気がする。
- todoアプリに対してもオプション解析機能を追加することに。
- オプション解析機能として今回は、GLIというGemを使うらしい。
- GLIで`scaffold`して動かそうとしたら`aruba`っていうGemが追加で必要らしい。これは追加でgem installする。

## 2014年12月27日（土）

- ここらでテストを書こうとしたけど、どうにもこうにも書きにくい。
  - `optparse`の解析結果をテストしようとしたけど、どうやってテストを書けばいいか分からなかった。
  - というわけで、ここでテストを書くのはやめ。
- `opts.on("-u USER", /^.+\..+$/)`でオプションの引数の正規表現validationが可能。
- これにマッチしない引数を指定すると、`invalid argument: -u hoge (OptionParser::InvalidArgument)`と出てくる。

## 2014年12月26日（金）

- オプションの実装は、`optparse`を使うと楽に書ける。
- `optparse`の説明はるりま（http://docs.ruby-lang.org/ja/2.1.0/library/optparse.html）を参照。
- P22では、userオプションの引数にとるUSERのvalidationを追加している。
  - validationはファーストネーム + ピリオド（.） + ラストネームの形とする。

## 2014年12月23日（火）

- db_backup.rbをより使いやすくするために、オプション解析機能をつける。
- `-p`はパスワード、`-u`はユーザ名、`-i`は繰り返すかそうでないかのオプション。end-of-iterationの役割。
- データベース名にはオプション名を付けない

## 2014年12月22日（月）

- P13から第2章。使いやすくするために、まずはコマンドラインのオプションや引数やコマンドなどを実装する
- オプションの指定は様々。オプションごとに一つ一つ分けたり（`-l -a -t`）、一個に統一（`-lat`）したり。
- 短いバージョン以外にも長いバージョンが有る。
- 引数は、オプションではないものって書いてあるんだけど、これだと次のコマンドと区別がつかないような
- コマンドは、executableに対する命令ってな感じかな？`git`コマンドだと`commit`とか`add`とか。
- コマンドというよりかはサブコマンドって言ったほうがしっくり来る。

## 2014年12月19日（金）

- todo-*.rbは3つに分かれているけど、似たようなソースがそれぞれに実装されていたりする。
- そこで、todoというアプリを作ってこの3つをまとめることにする。
- 第一引数でnew、list、doneを取るようにして、処理内容を変えることにする。
- 実装がP9。

## 2014年12月17日（水）

- P5では最初のプログラムを修正して、データベース名、ユーザ名、パスワードなどを引数で取れるようにしている。
- 他のデータベースをバックアップの対象としたいときなどプログラムの修正する必要がなくなる。
- このプログラムはこの本を通して改善を続けるようだ。
- 1.2でタスクマネジメントツール。色々あるけど、すっごくシンプルなものを作る。メモ紙に書き殴る感じのもの。
- そのために3つのプログラムを作る。todo-new.rb、todo-list.rb、todo-done.rbの3つ。

## 2014年12月12日（金）

- コマンドラインのアプリケーションの例として、MySQLのデータバックアッププログラムツールを作っていく。
- end-of-iterationってなんだろう。
- とりあえず、最初の実装がP3にある。


